// Generated by Haxe 4.1.0-rc.1+0d88c583b

#pragma warning disable 109, 114, 219, 429, 168, 162
namespace haxe.zip {
	public class Huffman : global::haxe.lang.Enum {
		
		protected Huffman(int index) : base(index) {
		}
		
		
		public static global::haxe.zip.Huffman Found(int i) {
			return new global::haxe.zip.Huffman_Found(i);
		}
		
		
		public static global::haxe.zip.Huffman NeedBit(global::haxe.zip.Huffman left, global::haxe.zip.Huffman right) {
			return new global::haxe.zip.Huffman_NeedBit(left, right);
		}
		
		
		public static global::haxe.zip.Huffman NeedBits(int n, global::haxe.root.Array table) {
			return new global::haxe.zip.Huffman_NeedBits(n, table);
		}
		
		
		protected static readonly string[] __hx_constructs = new string[]{"Found", "NeedBit", "NeedBits"};
		
	}
}



#pragma warning disable 109, 114, 219, 429, 168, 162
namespace haxe.zip {
	public sealed class Huffman_Found : global::haxe.zip.Huffman {
		
		public Huffman_Found(int i) : base(0) {
			this.i = i;
		}
		
		
		public override global::haxe.root.Array getParams() {
			return new global::haxe.root.Array(new object[]{this.i});
		}
		
		
		public override string getTag() {
			return "Found";
		}
		
		
		public override int GetHashCode() {
			return global::haxe.lang.Enum.paramsGetHashCode(0, new object[]{this.i});
		}
		
		
		public override bool Equals(object other) {
			if (global::System.Object.ReferenceEquals(((object) (this) ), ((object) (other) ))) {
				return true;
			}
			
			global::haxe.zip.Huffman_Found en = ( other as global::haxe.zip.Huffman_Found );
			if (( en == null )) {
				return false;
			}
			
			if ( ! (global::haxe.root.Type.enumEq(((object) (this.i) ), ((object) (en.i) ))) ) {
				return false;
			}
			
			return true;
		}
		
		
		public override string toString() {
			return global::haxe.lang.Enum.paramsToString("Found", new object[]{this.i});
		}
		
		
		public readonly int i;
		
	}
}



#pragma warning disable 109, 114, 219, 429, 168, 162
namespace haxe.zip {
	public sealed class Huffman_NeedBit : global::haxe.zip.Huffman {
		
		public Huffman_NeedBit(global::haxe.zip.Huffman left, global::haxe.zip.Huffman right) : base(1) {
			this.left = left;
			this.right = right;
		}
		
		
		public override global::haxe.root.Array getParams() {
			return new global::haxe.root.Array(new object[]{this.left, this.right});
		}
		
		
		public override string getTag() {
			return "NeedBit";
		}
		
		
		public override int GetHashCode() {
			unchecked {
				return global::haxe.lang.Enum.paramsGetHashCode(1, new object[]{this.left, this.right});
			}
		}
		
		
		public override bool Equals(object other) {
			if (global::System.Object.ReferenceEquals(((object) (this) ), ((object) (other) ))) {
				return true;
			}
			
			global::haxe.zip.Huffman_NeedBit en = ( other as global::haxe.zip.Huffman_NeedBit );
			if (( en == null )) {
				return false;
			}
			
			if ( ! (global::haxe.root.Type.enumEq(((object) (this.left) ), ((object) (en.left) ))) ) {
				return false;
			}
			
			if ( ! (global::haxe.root.Type.enumEq(((object) (this.right) ), ((object) (en.right) ))) ) {
				return false;
			}
			
			return true;
		}
		
		
		public override string toString() {
			return global::haxe.lang.Enum.paramsToString("NeedBit", new object[]{this.left, this.right});
		}
		
		
		public readonly global::haxe.zip.Huffman left;
		
		public readonly global::haxe.zip.Huffman right;
		
	}
}



#pragma warning disable 109, 114, 219, 429, 168, 162
namespace haxe.zip {
	public sealed class Huffman_NeedBits : global::haxe.zip.Huffman {
		
		public Huffman_NeedBits(int n, global::haxe.root.Array table) : base(2) {
			this.n = n;
			this.table = table;
		}
		
		
		public override global::haxe.root.Array getParams() {
			return new global::haxe.root.Array(new object[]{this.n, this.table});
		}
		
		
		public override string getTag() {
			return "NeedBits";
		}
		
		
		public override int GetHashCode() {
			unchecked {
				return global::haxe.lang.Enum.paramsGetHashCode(2, new object[]{this.n, this.table});
			}
		}
		
		
		public override bool Equals(object other) {
			if (global::System.Object.ReferenceEquals(((object) (this) ), ((object) (other) ))) {
				return true;
			}
			
			global::haxe.zip.Huffman_NeedBits en = ( other as global::haxe.zip.Huffman_NeedBits );
			if (( en == null )) {
				return false;
			}
			
			if ( ! (global::haxe.root.Type.enumEq(((object) (this.n) ), ((object) (en.n) ))) ) {
				return false;
			}
			
			if ( ! (global::haxe.root.Type.enumEq(((object) (this.table) ), ((object) (en.table) ))) ) {
				return false;
			}
			
			return true;
		}
		
		
		public override string toString() {
			return global::haxe.lang.Enum.paramsToString("NeedBits", new object[]{this.n, this.table});
		}
		
		
		public readonly int n;
		
		public readonly global::haxe.root.Array table;
		
	}
}



#pragma warning disable 109, 114, 219, 429, 168, 162
namespace haxe.zip {
	public class HuffTools : global::haxe.lang.HxObject {
		
		public HuffTools(global::haxe.lang.EmptyObject empty) {
		}
		
		
		public HuffTools() {
			global::haxe.zip.HuffTools.__hx_ctor_haxe_zip_HuffTools(this);
		}
		
		
		protected static void __hx_ctor_haxe_zip_HuffTools(global::haxe.zip.HuffTools __hx_this) {
		}
		
		
		public virtual int treeDepth(global::haxe.zip.Huffman t) {
			unchecked {
				switch (t._hx_index) {
					case 0:
					{
						int _g = ( t as global::haxe.zip.Huffman_Found ).i;
						return 0;
					}
					
					
					case 1:
					{
						global::haxe.zip.Huffman b = ( t as global::haxe.zip.Huffman_NeedBit ).right;
						global::haxe.zip.Huffman a = ( t as global::haxe.zip.Huffman_NeedBit ).left;
						int da = this.treeDepth(a);
						int db = this.treeDepth(b);
						return ( 1 + (( (( da < db )) ? (da) : (db) )) );
					}
					
					
					case 2:
					{
						global::haxe.root.Array _g2 = ( t as global::haxe.zip.Huffman_NeedBits ).table;
						int _g1 = ( t as global::haxe.zip.Huffman_NeedBits ).n;
						throw global::haxe.lang.HaxeException.wrap("assert");
					}
					
					
				}
				
				return default(int);
			}
		}
		
		
		public virtual global::haxe.zip.Huffman treeCompress(global::haxe.zip.Huffman t) {
			unchecked {
				int d = this.treeDepth(t);
				if (( d == 0 )) {
					return t;
				}
				
				if (( d == 1 )) {
					if (( t._hx_index == 1 )) {
						global::haxe.zip.Huffman b = ( t as global::haxe.zip.Huffman_NeedBit ).right;
						global::haxe.zip.Huffman a = ( t as global::haxe.zip.Huffman_NeedBit ).left;
						return global::haxe.zip.Huffman.NeedBit(this.treeCompress(a), this.treeCompress(b));
					}
					else {
						throw global::haxe.lang.HaxeException.wrap("assert");
					}
					
				}
				
				int size = ( 1 << d );
				global::haxe.root.Array table = new global::haxe.root.Array();
				{
					int _g = 0;
					int _g1 = size;
					while (( _g < _g1 )) {
						int i = _g++;
						table.push(global::haxe.zip.Huffman.Found(-1));
					}
					
				}
				
				this.treeWalk(table, 0, 0, d, t);
				return global::haxe.zip.Huffman.NeedBits(d, table);
			}
		}
		
		
		public virtual void treeWalk(global::haxe.root.Array table, int p, int cd, int d, global::haxe.zip.Huffman t) {
			unchecked {
				if (( t._hx_index == 1 )) {
					global::haxe.zip.Huffman b = ( t as global::haxe.zip.Huffman_NeedBit ).right;
					global::haxe.zip.Huffman a = ( t as global::haxe.zip.Huffman_NeedBit ).left;
					if (( d > 0 )) {
						this.treeWalk(table, p, ( cd + 1 ), ( d - 1 ), a);
						this.treeWalk(table, ( p | ( 1 << cd ) ), ( cd + 1 ), ( d - 1 ), b);
					}
					else {
						global::haxe.zip.Huffman __temp_expr2 = ((global::haxe.zip.Huffman) (table.__set(p, this.treeCompress(t))) );
					}
					
				}
				else {
					global::haxe.zip.Huffman __temp_expr1 = ((global::haxe.zip.Huffman) (table.__set(p, this.treeCompress(t))) );
				}
				
			}
		}
		
		
		public virtual global::haxe.zip.Huffman treeMake(global::haxe.ds.IntMap bits, int maxbits, int v, int len) {
			unchecked {
				if (( len > maxbits )) {
					throw global::haxe.lang.HaxeException.wrap("Invalid huffman");
				}
				
				int idx = ( ( v << 5 ) | len );
				if (bits.exists(((int) (idx) ))) {
					return global::haxe.zip.Huffman.Found(((int) (global::haxe.lang.Runtime.toInt(bits.@get(((int) (idx) )))) ));
				}
				
				v <<= 1;
				 ++ len;
				return global::haxe.zip.Huffman.NeedBit(this.treeMake(bits, maxbits, v, len), this.treeMake(bits, maxbits, ( v | 1 ), len));
			}
		}
		
		
		public virtual global::haxe.zip.Huffman make(global::haxe.root.Array lengths, int pos, int nlengths, int maxbits) {
			unchecked {
				if (( nlengths == 1 )) {
					return global::haxe.zip.Huffman.NeedBit(global::haxe.zip.Huffman.Found(0), global::haxe.zip.Huffman.Found(0));
				}
				
				global::haxe.root.Array counts = new global::haxe.root.Array();
				global::haxe.root.Array tmp = new global::haxe.root.Array();
				if (( maxbits > 32 )) {
					throw global::haxe.lang.HaxeException.wrap("Invalid huffman");
				}
				
				{
					int _g = 0;
					int _g1 = maxbits;
					while (( _g < _g1 )) {
						int i = _g++;
						counts.push(0);
						tmp.push(0);
					}
					
				}
				
				{
					int _g2 = 0;
					int _g3 = nlengths;
					while (( _g2 < _g3 )) {
						int i1 = _g2++;
						int p = ((int) (global::haxe.lang.Runtime.toInt(lengths.__get(( i1 + pos )))) );
						if (( p >= maxbits )) {
							throw global::haxe.lang.HaxeException.wrap("Invalid huffman");
						}
						
						{
							int __temp_arrVal1 = ((int) (global::haxe.lang.Runtime.toInt(counts.__get(p))) );
							int __temp_arrRet2 = __temp_arrVal1++;
							int __temp_expr1 = ((int) (global::haxe.lang.Runtime.toInt(counts.__set(p, __temp_arrVal1))) );
							int __temp_expr2 = __temp_arrRet2;
						}
						
					}
					
				}
				
				int code = 0;
				{
					int _g4 = 1;
					int _g5 = ( maxbits - 1 );
					while (( _g4 < _g5 )) {
						int i2 = _g4++;
						code = ( ( code + ((int) (global::haxe.lang.Runtime.toInt(counts.__get(i2))) ) ) << 1 );
						int __temp_expr3 = ((int) (global::haxe.lang.Runtime.toInt(tmp.__set(i2, code))) );
					}
					
				}
				
				global::haxe.ds.IntMap bits = new global::haxe.ds.IntMap();
				{
					int _g6 = 0;
					int _g7 = nlengths;
					while (( _g6 < _g7 )) {
						int i3 = _g6++;
						int l = ((int) (global::haxe.lang.Runtime.toInt(lengths.__get(( i3 + pos )))) );
						if (( l != 0 )) {
							int n = ((int) (global::haxe.lang.Runtime.toInt(tmp.__get(( l - 1 )))) );
							int __temp_expr4 = ((int) (global::haxe.lang.Runtime.toInt(tmp.__set(( l - 1 ), ( n + 1 )))) );
							bits.@set(((int) (( ( n << 5 ) | l )) ), ((object) (i3) ));
						}
						
					}
					
				}
				
				return this.treeCompress(global::haxe.zip.Huffman.NeedBit(this.treeMake(bits, maxbits, 0, 1), this.treeMake(bits, maxbits, 1, 1)));
			}
		}
		
		
		public override object __hx_getField(string field, int hash, bool throwErrors, bool isCheck, bool handleProperties) {
			unchecked {
				switch (hash) {
					case 1213610478:
					{
						return ((global::haxe.lang.Function) (new global::haxe.lang.Closure(this, "make", 1213610478)) );
					}
					
					
					case 740165228:
					{
						return ((global::haxe.lang.Function) (new global::haxe.lang.Closure(this, "treeMake", 740165228)) );
					}
					
					
					case 851061127:
					{
						return ((global::haxe.lang.Function) (new global::haxe.lang.Closure(this, "treeWalk", 851061127)) );
					}
					
					
					case 567946016:
					{
						return ((global::haxe.lang.Function) (new global::haxe.lang.Closure(this, "treeCompress", 567946016)) );
					}
					
					
					case 1110774469:
					{
						return ((global::haxe.lang.Function) (new global::haxe.lang.Closure(this, "treeDepth", 1110774469)) );
					}
					
					
					default:
					{
						return base.__hx_getField(field, hash, throwErrors, isCheck, handleProperties);
					}
					
				}
				
			}
		}
		
		
		public override object __hx_invokeField(string field, int hash, object[] dynargs) {
			unchecked {
				switch (hash) {
					case 1213610478:
					{
						return this.make(((global::haxe.root.Array) (((object) (dynargs[0]) )) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[1]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[2]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[3]) ))) ));
					}
					
					
					case 740165228:
					{
						return this.treeMake(((global::haxe.ds.IntMap) (((object) (dynargs[0]) )) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[1]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[2]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[3]) ))) ));
					}
					
					
					case 851061127:
					{
						this.treeWalk(((global::haxe.root.Array) (((object) (dynargs[0]) )) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[1]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[2]) ))) ), ((int) (global::haxe.lang.Runtime.toInt(((object) (dynargs[3]) ))) ), ((global::haxe.zip.Huffman) (((object) (dynargs[4]) )) ));
						break;
					}
					
					
					case 567946016:
					{
						return this.treeCompress(((global::haxe.zip.Huffman) (((object) (dynargs[0]) )) ));
					}
					
					
					case 1110774469:
					{
						return this.treeDepth(((global::haxe.zip.Huffman) (((object) (dynargs[0]) )) ));
					}
					
					
					default:
					{
						return base.__hx_invokeField(field, hash, dynargs);
					}
					
				}
				
				return null;
			}
		}
		
		
	}
}


